"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4392],{38597:function(e){e.exports={URLS:{streamUrl:"https://stream.uxpilot.ai",authFuncUrl:"https://us-central1-uxpilot-auth.cloudfunctions.net",kbUrl:"https://kb.uxpilot.ai"},isProd:!0,isDev:!1,isLocal:!1,FEATURE_FLAGS:{L1_GENERATION:!1}}},82469:function(e,t,r){r.d(t,{I3:function(){return s},YN:function(){return i},ZC:function(){return o}});var n,a=r(21575),i={UXP_08:"uxp-08",UXP_17:"uxp-17",UXP_02:"uxp-02",UXP_32:"uxp-32",UXP_13:"uxp-13",UXP_52:"uxp-52",UXP_18:"uxp-18"},o={CONTROL:"control",UXP_08:{CONTROL:"control",VARIANT_1:"test_group_1",VARIANT_2:"test_group_2",VARIANT_3:"test_group_3",VARIANT_4:"test_group_4",VARIANT_5:"test_group_5",VARIANT_6:"test_group_6"},UXP_17:{CONTROL:"control",VARIANT_1:"top_brands_variant"},UXP_18:{CONTROL:"control",VARIANT_1:"new_design",VARIANT_2:"new_price",VARIANT_3:"new_price_design"},UXP_02:{CONTROL:"control",SHOW_TOOLTIP:"show_tooltip"},UXP_32:{CONTROL:"control",VARIANT_1:"variant_1",VARIANT_2:"variant_2",VARIANT_3:"variant_3"},UXP_13:{CONTROL:"control",SIMPLIFIED_SIGNUP:"simplified_signup"},UXP_52:{CONTROL:"control",PAIN_BASED:"pain_based",BENEFIT_BASED:"benefit_based"}},s=(n={},(0,a._)(n,i.UXP_08,o.UXP_08.CONTROL),(0,a._)(n,i.UXP_17,o.UXP_17.CONTROL),(0,a._)(n,i.UXP_18,o.UXP_18.CONTROL),(0,a._)(n,i.UXP_02,o.UXP_02.CONTROL),(0,a._)(n,i.UXP_32,o.UXP_32.CONTROL),(0,a._)(n,i.UXP_13,o.UXP_13.CONTROL),(0,a._)(n,i.UXP_52,o.UXP_52.CONTROL),n)},4392:function(e,t,r){r.d(t,{ZP:function(){return Contexts_AuthProvider},aC:function(){return useAuth}});var n,a=r(45610),i=r(41369),o=r(43654),s=r(9),u=r(50044),c=r(57437),l=r(2265),d=r(27007),p=r(30791),f=r(79398),h=r(60453),g=r(45511),getGA4ClientId=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e4;return new Promise(function(n,a){var attemptGetClientId=function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;window.gtag?window.gtag("get","G-9L2Y115NQ3","client_id",function(o){o?n(o):i<e?setTimeout(function(){return attemptGetClientId(i+1)},Math.min(t*Math.pow(2,i),r)):a(Error("Failed to get GA4 Client ID after multiple attempts"))}):i<e?setTimeout(function(){return attemptGetClientId(i+1)},Math.min(t*Math.pow(2,i),r)):a(Error("gtag not available after multiple attempts"))};attemptGetClientId()})},_=(n=(0,a._)(function(){var e,t,r,n=arguments;return(0,u.Jh)(this,function(a){switch(a.label){case 0:if(!(n.length>0&&void 0!==n[0]&&n[0])&&(e=localStorage.getItem("ga4ClientId")))return console.log("GA4 Client ID available from cache:",e),[2,e];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,getGA4ClientId()];case 2:if(t=a.sent())return localStorage.setItem("ga4ClientId",t),console.log("GA4 Client ID retrieved successfully:",t),[2,t];throw Error("No client ID returned from GA4");case 3:throw console.error("Failed to retrieve GA4 Client ID:",r=a.sent()),r;case 4:return[2]}})}),function(){return n.apply(this,arguments)});(0,a._)(function(){return(0,u.Jh)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,_()];case 1:return e.sent(),[2,!0];case 2:return e.sent(),[2,!1];case 3:return[2]}})});var getCookie=function(e){var t=document.cookie.match(RegExp("(^| )"+e+"=([^;]+)"));return t?t[2]:null},getGclAwValue=function(){var checkForCookie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,r=getCookie("_gcl_aw");if(r){var n=r.split(".").slice(2).join(".");return n&&localStorage.setItem("gclAw",n),!0}return e<t&&setTimeout(function(){return checkForCookie(e+1)},2e3),!1};checkForCookie()},getReferringUrl=function(){var e=window.location.href;return e.includes("?")?e:document.referrer||e},getFbclidValue=function(){var checkForCookie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,r=getCookie("_fbc");return r?(localStorage.setItem("fbc",r),!0):(e<t&&setTimeout(function(){return checkForCookie(e+1)},2e3),!1)};checkForCookie()},getFbpValue=function(){var checkForCookie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,r=getCookie("_fbp");return r?(localStorage.setItem("fbp",r),!0):(e<t&&setTimeout(function(){return checkForCookie(e+1)},2e3),!1)};checkForCookie()},useTrackingData=function(){var e=(0,s._)((0,l.useState)({referringUrl:null,gclAw:null,ga4ClientId:null,fbc:null,fbp:null}),2),t=e[0],r=e[1];return(0,l.useEffect)(function(){if(localStorage.getItem("referringUrl")||localStorage.setItem("referringUrl",getReferringUrl()),localStorage.getItem("gclAw")||getGclAwValue(),localStorage.getItem("fbc")||getFbclidValue(),localStorage.getItem("fbp")||getFbpValue(),!localStorage.getItem("ga4ClientId")){var e,t=(e=(0,a._)(function(){return(0,u.Jh)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,_()];case 1:return e.sent(),[3,3];case 2:return console.error("Failed to retrieve GA4 Client ID in useTrackingData:",e.sent()),[3,3];case 3:return[2]}})}),function(){return e.apply(this,arguments)});setTimeout(function(){t()},3e3)}r({referringUrl:localStorage.getItem("referringUrl"),gclAw:localStorage.getItem("gclAw"),ga4ClientId:localStorage.getItem("ga4ClientId"),fbc:localStorage.getItem("fbc"),fbp:localStorage.getItem("fbp")})},[]),t},m=r(90335),v=r(29467),E=r(82469),I=(0,l.createContext)(),useAuth=function(){return(0,l.useContext)(I)},Contexts_AuthProvider=function(e){var t,r,n,_,U,y,S,A,w,T,b,R,P,k,C,N,O=e.children,D=(0,f.z)(),x=(t=(0,f.z)().capture,{trackEvent:(0,l.useCallback)(function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};g.Z.trackEvent(e,r),t(e,r)},[]),trackSignUp:(0,l.useCallback)(function(e,r,n){g.Z.trackSignUp(e,r,n),t("c_sign_up",{user_id:e,method:r,email:n})},[t]),trackSignIn:(0,l.useCallback)(function(e,r){g.Z.trackSignIn(e,r),t("c_sign_in",{user_id:e,method:r})},[t]),trackVerificationPageVisit:(0,l.useCallback)(function(){g.Z.trackVerificationPageVisit()},[]),trackAccountVerified:(0,l.useCallback)(function(e){g.Z.trackAccountVerified(e)},[]),trackPurchase:(0,l.useCallback)(function(e){var r=e.user_id,n=e.plan,a=e.email,i=e.currency,o=e.value,s=e.subscription_id;g.Z.trackPurchase({user_id:r,plan:n,email:a,currency:i,value:o,subscription_id:s}),t("c_purchase",{user_id:r,plan:n,email:a,currency:i,value:o})},[t])}),L=(0,s._)((0,l.useState)(null),2),V=L[0],F=L[1],G=(0,s._)((0,l.useState)(null),2),W=G[0],X=G[1],M=(0,s._)((0,l.useState)(!0),2),q=M[0],J=M[1];useTrackingData();var Y=(0,v.j)().experiments[E.YN.UXP_18],j=null!==(N=null==Y?void 0:Y.variant)&&void 0!==N?N:E.ZC.UXP_18.CONTROL,H=(0,l.useRef)(!0);(0,l.useEffect)(function(){return function(){H.current=!1}},[]);var safeSetState=function(e,t){H.current&&e(t)},Z=(0,m.gw)({uid:W},{skip:!W}),B=Z.data,z=Z.refetch,Q=(0,s._)((0,m.Rs)(),1)[0],K=(0,s._)((0,m.Wd)(),1)[0],$=(0,s._)((0,m.UE)(),1)[0],ee=(0,s._)((0,m.lo)(),1)[0],et=(0,s._)((0,m.yL)(),1)[0],er=(0,s._)((0,m.NZ)(),1)[0],en=(0,s._)((0,m.pr)(),1)[0],ea=(r=(0,a._)(function(e){return(0,u.Jh)(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,fetch("https://ipapi.co/".concat(e,"/json/"))];case 1:return[4,t.sent().json()];case 2:return[2,t.sent().country_name];case 3:return console.warn("Error getting location data:",t.sent()),[2,null];case 4:return[2]}})}),function(e){return r.apply(this,arguments)}),getTrackingDataFromLocalStorage=function(){return{referringUrl:localStorage.getItem("referringUrl"),ga4ClientId:localStorage.getItem("ga4ClientId"),gclAwCookie:localStorage.getItem("gclAw"),fbc:localStorage.getItem("fbc"),fbp:localStorage.getItem("fbp")}},cleanObject=function(e){var t=(0,i._)({},e);return Object.keys(t).forEach(function(e){return void 0===t[e]||null===t[e]?delete t[e]:{}}),t},ei=(n=(0,a._)(function(e,t){var r,n,a,o,s,c,l,f,h,g,_,m;return(0,u.Jh)(this,function(u){switch(u.label){case 0:if(!(null==e?void 0:e.user))throw Error("No user object in authentication result");if(!e.user.emailVerified)throw{code:"auth/email-not-verified",message:"Email not verified",email:e.user.email,uuid:e.user.uid};if(r=e.user.uid,!(n=e.user.providerData.find(function(e){return"google.com"===e.providerId})))throw Error("Google provider data not found");a=n.uid,o=n.email,s=n.photoURL,c=n.displayName,u.label=1;case 1:return u.trys.push([1,5,,6]),[4,Q({uid:r}).unwrap()];case 2:if(!(l=u.sent()))return[3,4];return[4,$({uid:r,photoURL:s,displayName:c})];case 3:return u.sent(),H.current&&(safeSetState(X,r),localStorage.setItem("UxpUserID",r),s&&localStorage.setItem("userPhotoURL",s)),[2,l];case 4:return[3,6];case 5:return console.warn("Error checking for existing user:",u.sent()),[3,6];case 6:return u.trys.push([6,12,,13]),[4,K({email:o}).unwrap()];case 7:if(!(f=u.sent()))return[3,11];return[4,ee({uid:f.uid,linkedGoogleUid:a,linkedGoogleEmail:o,firebaseUid:r,photoURL:s})];case 8:return u.sent(),[4,(0,d.ck)(p.I8.currentUser,{photoURL:s})];case 9:return u.sent(),[4,Q({uid:f.uid}).unwrap()];case 10:return(h=u.sent())&&H.current&&(safeSetState(X,f.uid),localStorage.setItem("UxpUserID",f.uid),s&&localStorage.setItem("userPhotoURL",s)),[2,h];case 11:return[3,13];case 12:return console.warn("Error checking for user by email:",u.sent()),[3,13];case 13:return g=(null==c?void 0:c.split(" ")[0])||"",_=(null==c?void 0:c.split(" ").slice(1).join(" "))||"",m=getTrackingDataFromLocalStorage(),[4,et(cleanObject((0,i._)({uid:r,googleUid:a,email:o,photoURL:s,displayName:c,authMethod:t,uxp18Variant:j},m)))];case 14:return u.sent(),er(cleanObject((0,i._)({email:o,firstName:g,lastName:_,tag:"uxpilot"},m))).catch(function(e){return console.warn("Error adding to ActiveCampaign:",e)}),en().unwrap().then(function(e){ea(e.ip).then(function(e){e&&$({uid:r,userCountry:e})})}).catch(function(e){return console.warn("Error getting IP data:",e)}),H.current&&(safeSetState(X,r),localStorage.setItem("UxpUserID",r),s&&localStorage.setItem("userPhotoURL",s),x.trackSignUp(r,t,o)),[2,{uid:r,email:o,photoURL:s,displayName:c,onboardingCompleted:!1}]}})}),function(e,t){return n.apply(this,arguments)});(0,l.useEffect)(function(){var e,unsubscribe=function(){};try{unsubscribe=p.I8.onAuthStateChanged((e=(0,a._)(function(e){var t,r,n,a,i;return(0,u.Jh)(this,function(o){switch(o.label){case 0:if(o.trys.push([0,7,,8]),!H.current)return[2];if(!(null==e?void 0:e.emailVerified))return[3,5];safeSetState(F,e),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,K({email:e.email}).unwrap()];case 2:return(t=o.sent())&&H.current&&(safeSetState(X,t.uid),localStorage.setItem("UxpUserID",t.uid)),[3,4];case 3:return r=o.sent(),console.error("Error finding user by email:",r),[3,4];case 4:return safeSetState(J,!1),n=e.uid,a=e.providerData.some(function(e){return"google.com"===e.providerId}),D.identify(n,{distinct_id:n,email:e.email,name:e.displayName,profession:null==B?void 0:B.profession,provider:a?"google":"email",emailVerified:e.emailVerified}),[3,6];case 5:H.current&&(D.reset(),safeSetState(F,null),safeSetState(X,null),safeSetState(J,!1)),o.label=6;case 6:return[3,8];case 7:return i=o.sent(),console.error("Error in auth state change handler:",i),H.current&&safeSetState(J,!1),[3,8];case 8:return[2]}})}),function(t){return e.apply(this,arguments)}))}catch(e){console.error("Error setting up auth state listener:",e),H.current&&safeSetState(J,!1)}return function(){H.current=!1,unsubscribe()}},[]);var eo=(_=(0,a._)(function(){var e,t,r,n,a;return(0,u.Jh)(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),e=new d.hJ,[4,(0,d.rh)(p.I8,e)];case 1:return t=i.sent(),(0,h.hb)("googleSignIn"),[4,ei(t,"google")];case 2:return[2,i.sent()];case 3:if(console.error("Google sign in error:",r=i.sent()),"auth/account-exists-with-different-credential"===r.code||(null===(n=r.message)||void 0===n?void 0:n.includes("No user found")))return[2,{error:!0,code:"account-exists-with-email",email:(null===(a=r.customData)||void 0===a?void 0:a.email)||r.email,message:"An account already exists with this email. Please sign in with your password first, then link your Google account from Account Settings."}];throw r;case 4:return[2]}})}),function(){return _.apply(this,arguments)}),es=(U=(0,a._)(function(e){var t,r,n,a;return(0,u.Jh)(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),t=d.hJ.credential(e),[4,(0,d.sB)(p.I8,t)];case 1:return[4,ei(i.sent(),"google_one_tap")];case 2:return[2,i.sent()];case 3:if(console.error("Google One Tap sign in failed:",r=i.sent()),"auth/account-exists-with-different-credential"===r.code||(null===(n=r.message)||void 0===n?void 0:n.includes("No user found")))return[2,{error:!0,code:"account-exists-with-email",email:(null===(a=r.customData)||void 0===a?void 0:a.email)||r.email,message:"An account already exists with this email. Please sign in with your password first, then link your Google account from Account Settings."}];throw r;case 4:return[2]}})}),function(e){return U.apply(this,arguments)}),eu=(y=(0,a._)(function(){var e,t,r;return(0,u.Jh)(this,function(n){switch(n.label){case 0:if(!(e=p.I8.currentUser))throw Error("No user found. Please sign in or sign up first.");t=window.location.origin,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,e.sendEmailVerification({url:"".concat(t,"/b"),handleCodeInApp:!0})];case 2:return n.sent(),[3,4];case 3:throw console.error("Error sending verification email:",r=n.sent()),r;case 4:return[2]}})}),function(){return y.apply(this,arguments)}),ec=(S=(0,a._)(function(e,t,r){var n,a,o,s,c,l,f,h,g;return(0,u.Jh)(this,function(u){switch(u.label){case 0:return u.trys.push([0,9,,10]),n=e.trim().toLowerCase(),[4,(0,d.Xb)(p.I8,n,t)];case 1:return a=u.sent(),[4,(0,d.ck)(a.user,{displayName:r})];case 2:return u.sent(),F(null),[4,eu()];case 3:if(u.sent(),!(a&&a.user))return[3,8];s=a.user.uid,c=getTrackingDataFromLocalStorage(),l=(null==r?void 0:r.split(" ")[0])||"",f=(null==r?void 0:null===(o=r.split(" "))||void 0===o?void 0:o.slice(1).join(" "))||"",h=cleanObject((0,i._)({uid:s,email:n,displayName:r,authMethod:"email",uxp18Variant:j},c)),u.label=4;case 4:return u.trys.push([4,6,,7]),[4,et(h)];case 5:return u.sent(),[3,7];case 6:return console.warn("Error adding user to DB:",u.sent()),[3,7];case 7:x.trackSignUp(s,"email_password",e),localStorage.setItem("UxpUserID",s),er(cleanObject((0,i._)({email:e,firstName:l,lastName:f,tag:"uxpilot"},c))).catch(function(e){return console.warn("Error adding to ActiveCampaign:",e)}),en().unwrap().then(function(e){ea(e.ip).then(function(e){e&&$({uid:s,userCountry:e})})}).catch(function(e){console.warn("Error getting IP data:",e)}),D.identify(s,{distinct_id:s,email:n,name:r,provider:"email",emailVerified:!1}),u.label=8;case 8:return[2,{uid:a.user.uid}];case 9:switch(console.error("Error in signUp:",g=u.sent()),g.code){case"auth/email-already-in-use":return[2,{code:"auth/email-already-in-use",message:"This email is already registered. Please sign in to your existing account."}];case"auth/invalid-email":return[2,{code:"auth/invalid-email",message:"The email address is not valid."}];case"auth/operation-not-allowed":return[2,{code:"auth/operation-not-allowed",message:"Email/password accounts are not enabled. Please contact support."}];case"auth/weak-password":return[2,{code:"auth/weak-password",message:"The password is too weak. Please use at least 8 characters."}];default:return[2,{code:g.code||"auth/unknown",message:g.message||"An error occurred during signup. Please try again."}]}return[3,10];case 10:return[2]}})}),function(e,t,r){return S.apply(this,arguments)}),el=(A=(0,a._)(function(e,t){var r,n,a,i,o,s,c,l,f,g,_;return(0,u.Jh)(this,function(u){switch(u.label){case 0:u.trys.push([0,7,,8]),r=e.trim().toLowerCase(),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,K({email:r}).unwrap()];case 2:return n=u.sent(),[3,4];case 3:if((null==(a=u.sent())?void 0:null===(i=a.data)||void 0===i?void 0:i.message)==="User not found")return[2,{code:"auth/invalid-credential",message:"Invalid email or password. Please try again."}];return[3,4];case 4:return[4,(0,d.e5)(p.I8,r,t)];case 5:if(!(o=u.sent().user))throw Error("Sign-in failed: No user returned from Firebase.");return[4,o.getIdToken()];case 6:return s=u.sent(),(0,h.hb)("googleSignIn"),c=o.uid,o.photoURL&&localStorage.setItem("userPhotoURL",o.photoURL),l=null==n?void 0:n.onboardingCompleted,o&&D.identify(c,{distinct_id:c,email:r,name:o.displayName,provider:o.providerData.some(function(e){return"google.com"===e.providerId})?"google":"email",emailVerified:o.emailVerified}),(null==o?void 0:o.emailVerified)&&!1===l&&(safeSetState(F,o),safeSetState(X,o.uid),localStorage.setItem("UxpUserID",o.uid)),[2,{providerData:null!==(f=o.providerData)&&void 0!==f?f:[],uid:c,user:o,token:s,email:r,onboardingCompleted:l}];case 7:if("auth/invalid-email"===(g=u.sent()).code||"auth/wrong-password"===g.code||"auth/user-not-found"===g.code||"auth/invalid-credential"===g.code||(null===(_=g.message)||void 0===_?void 0:_.includes("INVALID_LOGIN_CREDENTIALS")))return[2,{code:"auth/invalid-credential",message:"Invalid username or password. Please try again."}];throw console.error("Sign-in failed:",g),g;case 8:return[2]}})}),function(e,t){return A.apply(this,arguments)}),ed=(w=(0,a._)(function(){var e,t,r,n,a,s,c,l,f;return(0,u.Jh)(this,function(u){switch(u.label){case 0:if(u.trys.push([0,8,,9]),!p.I8.currentUser)throw Error("You must be signed in to link accounts");return e=new d.hJ,[4,p.I8.currentUser.linkWithPopup(e)];case 1:if(r=(t=u.sent()).user.uid,!(n=t.user.providerData.find(function(e){return"google.com"===e.providerId})))return[3,7];a=n.uid,s=n.email,c=n.photoURL,l=n.displayName,u.label=2;case 2:return u.trys.push([2,6,,7]),[4,ee({uid:r,linkedGoogleUid:a,linkedGoogleEmail:s,photoURL:c,displayName:l||(null==V?void 0:V.displayName)})];case 3:if(u.sent(),!c)return[3,5];return[4,(0,d.ck)(p.I8.currentUser,{photoURL:c})];case 4:u.sent(),V&&F((0,o._)((0,i._)({},V),{photoURL:c})),u.label=5;case 5:return[3,7];case 6:return console.warn("Error updating user data with linked Google account:",u.sent()),[3,7];case 7:return[2,!0];case 8:if(console.error("Error linking Google account:",f=u.sent()),"auth/credential-already-in-use"===f.code)throw Error("This Google account is already linked to another user.");if("auth/email-already-in-use"===f.code)throw Error("This Google account's email is already in use by another account.");throw f;case 9:return[2]}})}),function(){return w.apply(this,arguments)}),ep=(T=(0,a._)(function(e){var t,r;return(0,u.Jh)(this,function(n){switch(n.label){case 0:if(n.trys.push([0,4,,5]),!p.I8.currentUser)throw Error("You must be signed in to set a password");if(p.I8.currentUser.providerData.some(function(e){return"password"===e.providerId}))throw Error("This account already has a password set");return t=p.ZP.auth.EmailAuthProvider.credential(p.I8.currentUser.email,e),[4,p.I8.currentUser.linkWithCredential(t)];case 1:return n.sent(),[4,p.I8.currentUser.reload()];case 2:return n.sent(),[4,p.I8.currentUser.sendEmailVerification({url:window.location.origin,handleCodeInApp:!0})];case 3:return n.sent(),[2,!0];case 4:throw console.error("Error setting password for OAuth user:",r=n.sent()),r;case 5:return[2]}})}),function(e){return T.apply(this,arguments)}),ef=(b=(0,a._)(function(e,t){var r,n;return(0,u.Jh)(this,function(a){switch(a.label){case 0:if(a.trys.push([0,3,,4]),!p.I8.currentUser)throw Error("You must be signed in to change password");return r=p.ZP.auth.EmailAuthProvider.credential(p.I8.currentUser.email,e),[4,p.I8.currentUser.reauthenticateWithCredential(r)];case 1:return a.sent(),[4,p.I8.currentUser.updatePassword(t)];case 2:return a.sent(),[2,!0];case 3:throw console.error("Error changing password:",n=a.sent()),n;case 4:return[2]}})}),function(e,t){return b.apply(this,arguments)}),eh=(R=(0,a._)(function(e){var t;return(0,u.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,p.I8.verifyPasswordResetCode(e)];case 1:return[2,r.sent()];case 2:throw console.error("Error verifying reset code:",t=r.sent()),t;case 3:return[2]}})}),function(e){return R.apply(this,arguments)}),eg=(P=(0,a._)(function(e){var t;return(0,u.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,p.I8.applyActionCode(e)];case 1:return[2,r.sent()];case 2:throw console.error("Error applying action code:",t=r.sent()),t;case 3:return[2]}})}),function(e){return P.apply(this,arguments)}),e_=(k=(0,a._)(function(e,t){var r;return(0,u.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,p.I8.confirmPasswordReset(e,t)];case 1:return[2,n.sent()];case 2:throw console.error("Error confirming password reset:",r=n.sent()),r;case 3:return[2]}})}),function(e,t){return k.apply(this,arguments)}),em=(C=(0,a._)(function(e){var t;return(0,u.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,p.I8.checkActionCode(e)];case 1:return[2,r.sent()];case 2:throw console.error("Error checking action code:",t=r.sent()),t;case 3:return[2]}})}),function(e){return C.apply(this,arguments)});return(0,c.jsx)(I.Provider,{value:{currentUser:V,signInWithGoogle:eo,authLoading:q,googleUID:W,signUp:ec,signIn:el,userInfo:B||null,refetch:z,signInWithGoogleOneTap:es,linkWithGoogleAccount:ed,setPasswordForOAuthUser:ep,changePassword:ef,verifyPasswordResetCode:eh,applyActionCode:eg,confirmPasswordReset:e_,checkActionCode:em,sendVerificationEmail:eu},children:O})}},29467:function(e,t,r){r.d(t,{V:function(){return ExperimentsProvider},j:function(){return useExperiments}});var n=r(21575),a=r(57437),i=r(2265),o=r(41369),s=r(9),u=r(53611);function useExperiment(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.defaultVariant,n=t.sendExposureEvent,a=void 0===n||n,c=t.properties,l=void 0===c?{}:c,d=(0,u.U0)(),p=(0,s._)((0,i.useState)(!0),2),f=p[0],h=p[1],g=(0,s._)((0,i.useState)(!0),2),_=g[0],m=g[1],v=(0,u.ZR)(e),E=(0,s._)((0,i.useState)(v||(void 0===r?"control":r)),2),I=E[0],U=E[1],y=null!=v;return(0,i.useEffect)(function(){var t=localStorage.getItem("experiment_variant_UXP-18");if(t&&"uxp-18"===e){U(t),m(!1);return}if(!d){h(!1);return}"uxp-18"===e&&v?(localStorage.setItem("experiment_variant_UXP-18",v),U(v),m(!1)):"uxp-18"!==e&&v&&U(v),y&&a&&d.capture("$experiment_viewed",(0,o._)({experiment:e,experiment_variant:I},l)),h(!1)},[d,e,I,y,a,l]),{isLoadingUXP18:_,variant:I,loading:f,enabled:y,isVariant:function(e){return I===e}}}var c=r(82469),l=(0,i.createContext)({experiments:{},isVariant:function(){return!1},isExperimentEnabled:function(){return!1}});function ExperimentsProvider(e){var t=e.children,r=useExperiment(c.YN.UXP_08,{defaultVariant:c.I3[c.YN.UXP_08],properties:{page:"homepage",element:"social_proof"}}),o=useExperiment(c.YN.UXP_17,{defaultVariant:c.I3[c.YN.UXP_17],properties:{page:"plans",element:"top_brands"}}),s=useExperiment(c.YN.UXP_18,{defaultVariant:c.I3[c.YN.UXP_18],properties:{page:"plans",element:"price_ab_testing"}}),u=useExperiment(c.YN.UXP_32,{defaultVariant:c.I3[c.YN.UXP_32],properties:{page:"homepage",element:"microtriggers"}}),d=useExperiment(c.YN.UXP_13,{defaultVariant:c.I3[c.YN.UXP_13],properties:{page:"homepage",element:"simplified_signup"}}),p=useExperiment(c.YN.UXP_52,{defaultVariant:c.I3[c.YN.UXP_52],properties:{page:"homepage",element:"pain_based_vs_benefit_based"}}),f=(0,i.useMemo)(function(){var e;return e={},(0,n._)(e,c.YN.UXP_08,r),(0,n._)(e,c.YN.UXP_17,o),(0,n._)(e,c.YN.UXP_18,s),(0,n._)(e,c.YN.UXP_32,u),(0,n._)(e,c.YN.UXP_13,d),(0,n._)(e,c.YN.UXP_52,p),e},[r,o,u,d,p,s]),isVariant=function(e,t){var r=f[e];return(null==r?void 0:r.variant)===t},isExperimentEnabled=function(e){var t=f[e];return(null==t?void 0:t.enabled)===!0},h=(0,i.useMemo)(function(){return{experiments:f,isVariant:isVariant,isExperimentEnabled:isExperimentEnabled}},[f]);return(0,a.jsx)(l.Provider,{value:h,children:t})}function useExperiments(){var e=(0,i.useContext)(l);if(void 0===e)throw Error("useExperiments must be used within an ExperimentsProvider");return e}},45511:function(e,t,r){var n=r(86335),a=r(40494),i=r(41369),o=r(87944),s=new(function(){function AnalyticsService(){(0,n._)(this,AnalyticsService),this.maxRetries=5,this.retryInterval=100}return(0,a._)(AnalyticsService,[{key:"trackEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.trackGTMEvent(e,t),this.trackVWOEvent(e,t)}},{key:"trackGTMEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this,pushDataLayer=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(window.dataLayer)try{window.dataLayer.push((0,i._)({event:e},t))}catch(t){console.error("Error tracking GTM event ".concat(e,":"),t)}else n<r.maxRetries&&setTimeout(function(){return pushDataLayer(n+1)},r.retryInterval)};pushDataLayer()}},{key:"trackVWOEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this,pushVWOEvent=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(window.VWO&&window.VWO.event)try{window.VWO.event(e,t)}catch(t){console.error("Error tracking VWO event ".concat(e,":"),t)}else n<r.maxRetries&&setTimeout(function(){return pushVWOEvent(n+1)},r.retryInterval)};pushVWOEvent()}},{key:"trackPageView",value:function(e,t){this.trackEvent("page_view",{page_path:e,page_title:t})}},{key:"trackSignUp",value:function(e,t,r){this.trackEvent("c_sign_up",{user_id:e,method:t,email:r})}},{key:"trackSignIn",value:function(e,t){this.trackEvent("c_sign_in",{user_id:e,method:t})}},{key:"trackVerificationPageVisit",value:function(){this.trackEvent("c_verification_page_visit")}},{key:"trackAccountVerified",value:function(e){this.trackEvent("c_account_verified",{user_id:e})}},{key:"trackPurchase",value:function(e){var t=e.user_id,r=e.plan,n=e.email,a=e.currency,s=e.value,u=e.subscription_id,c=e.phone;this.trackEvent("c_purchase",(0,i._)({plan_name:r,plan:r,price:s,value:s,user_id:t,email:n,currency:null!=a?a:"USD",subscription_id:u},c?{phone_number:c}:{})),(0,o.g8)(n,s,null!=a?a:"USD")}},{key:"trackLinkedInConversion",value:function(e){var t=this,trackLinkedIn=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(window.lintrk)try{window.lintrk("track",{conversion_id:e})}catch(e){console.error("LinkedIn tracking failed:",e)}else r<t.maxRetries&&setTimeout(function(){return trackLinkedIn(r+1)},t.retryInterval)};trackLinkedIn()}},{key:"validateEventData",value:function(e,t){return!0}}]),AnalyticsService}());t.Z=s},30791:function(e,t,r){r.d(t,{I8:function(){return o},tO:function(){return s}}),r(12075),r(648),r(61708);var n=r(78199),a=r(24086);n.Z.apps.length||n.Z.initializeApp({apiKey:"AIzaSyBvx3L1jW-Q53bHwZc22SZUufdXhxeWbwc",authDomain:"uxpilot-auth.firebaseapp.com",projectId:"uxpilot-auth",storageBucket:"uxpilot-auth.appspot.com",messagingSenderId:"485825078314",appId:"1:485825078314:web:b742b234195e58f8b74f53"});var i=n.Z.firestore(),o=n.Z.auth(),s=n.Z.storage();i.settings({cacheSizeBytes:a.IX,merge:!0}),i.enablePersistence({synchronizeTabs:!0}).catch(function(e){"failed-precondition"===e.code?console.warn("Firebase persistence unavailable - multiple tabs open"):"unimplemented"===e.code&&console.warn("Firebase persistence not supported in this browser")}),t.ZP=n.Z},87944:function(e,t,r){r.d(t,{G9:function(){return trackTwitterSignupConversion},g8:function(){return trackTwitterPurchaseConversion}});var trackTwitterConversion=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"tw-pqg9x-pqgbo",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;window.twq&&window.twq("event",e,{email_address:t,value:r,currency:n})},trackTwitterSignupConversion=function(){trackTwitterConversion("tw-pqg9x-pqgbo")},trackTwitterPurchaseConversion=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;trackTwitterConversion("tw-pqg9x-pqg9y",e,t,r)}},79398:function(e,t,r){r.d(t,{z:function(){return useAnalytics}});var n=r(41369),a=r(53611),i=r(29467);function useAnalytics(){var e=(0,a.U0)(),t=(0,i.j)().experiments;return{capture:function(r){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{if(e&&"function"==typeof e.capture){var i=Object.keys(t).reduce(function(e,r){var n=t[r];return(null==n?void 0:n.enabled)&&n.variant&&(e["$feature/".concat(r)]=n.variant),e},{});e.capture(r,(0,n._)({},a,i))}}catch(e){console.error("Analytics Error (".concat(r,"):"),e)}},identify:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{e&&"function"==typeof e.identify&&e.identify(t,r)}catch(e){console.error("Analytics Identify Error:",e)}},setUserProperties:function(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{e&&"function"==typeof(null===(t=e.people)||void 0===t?void 0:t.set)&&e.people.set(r)}catch(e){console.error("Analytics Set User Properties Error:",e)}},reset:function(){e&&"function"==typeof e.reset&&e.reset()}}}},60453:function(e,t,r){r.d(t,{hb:function(){return dispatchCustomEvent},zW:function(){return a}});var n=r(2265),a={wireframesData:"wireframesData",groupsData:"groupsData",userInfo:"userInfo",exportGroupWireframe:"exportGroupWireframe",saveGroupWireframe:"saveGroupWireframe",unsaveWireframe:"unsaveWireframe",saveWireframe:"saveWireframe",syncing:"syncing",pageDeleted:"pageDeleted",userInfoData:"userInfoData",panningEnabled:"panningEnabled",panningDisabled:"panningDisabled",sessionExpired:"login",googleSignIn:"googleSignIn",googleOneTabResponse:"googleOneTabResponse",openCreatePageModal:"openCreatePageModal",saveTextChanges:"saveTextChanges",discardTextChanges:"discardTextChanges",refreshSavedWireframes:"refreshSavedWireframes",unSaveWireframeFromToolbar:"unSaveWireframeFromToolbar",itemAttachedWithContext:"itemAttachedWithContext"};t.ZP=function(e,t){var r=(0,n.useCallback)(function(e){t(e.detail)},[t]);(0,n.useEffect)(function(){return document.addEventListener(e,r),function(){document.removeEventListener(e,r)}},[e,r])};var dispatchCustomEvent=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new CustomEvent(e,{detail:t});document.dispatchEvent(r)}},16958:function(e,t,r){r.d(t,{V:function(){return a},q:function(){return n}});var n={USER:"User",SUBSCRIPTION:"Subscription",CREDITS:"Credits",WIREFRAMES:"Wireframes",GROUPS:"Groups",PROMPTS:"Prompts",PAGES:"Pages",DESIGN_REVIEWS:"DesignReviews",USER_COUNT:"UserCount",PAYMENT_LOGS:"PaymentLogs",USER_IP:"UserIp",GENERATE:"Generate",GENERATE_HIFI:"GenerateHiFi",GENERATE_WIREFRAMES:"GenerateWireframes",GENERATE_BY_FLOW:"GenerateByFlow",HEATMAP:"Heatmap",SAVED_WIREFRAMES:"SavedWireframes",CANVAS_SHAPES:"CanvasShapes"},a={AUTH:"authApi",SUBSCRIPTION:"subscriptionApi",REVIEWS_QUERIES_MUTATIONS:"reviewsQueriesMutationsApi",UPLOAD_FILE:"uploadFileApi",UPLOAD_DOCUMENT:"uploadDocumentApi",UX_REVIEW:"uxReviewApi",USER_COUNT:"userCountApi",DESIGN:"designApi",WIREFRAMES:"wireframesApi",PROMPT:"promptApi",GROUPS:"groupsApi",PAGES:"pagesApi",SHARING:"sharingApi",CANVAS_SHAPES:"canvasShapesApi"}},90335:function(e,t,r){r.d(t,{iJ:function(){return f},NZ:function(){return U},yL:function(){return I},gw:function(){return h},Wd:function(){return _},Rs:function(){return g},pr:function(){return y},B1:function(){return v},e7:function(){return w},UE:function(){return m},lo:function(){return E},LF:function(){return A},aN:function(){return S}});var n,a=r(45610),i=r(50044),o=r(85687),s=r(65800),u=r(21575),c={GET_USER_DATA:"get-user-data",FIND_USER_BY_EMAIL:"find-user-by-email",UPDATE_USER_DATA:"update-user-data",UPDATE_TOUR_GUIDE:"update-tour-guide",UPDATE_CONTEXTUAL_TIPS:"update-contextual-tips",ADD_USER:"add-user-data",ADD_TO_AC:"add-to-ac",IPIFY:"https://api.ipify.org?format=json",USER_FEATURE_ANNOUNCEMENT:"user-feature-announcement",UPDATE_USER_PROFILE:"update-user-profile"},l={EMAIL_ALREADY_IN_USE:"auth/email-already-in-use",INVALID_EMAIL:"auth/invalid-email",USER_NOT_FOUND:"auth/user-not-found",WRONG_PASSWORD:"auth/wrong-password",WEAK_PASSWORD:"auth/weak-password",REQUIRES_RECENT_LOGIN:"auth/requires-recent-login",TOO_MANY_REQUESTS:"auth/too-many-requests",EMAIL_NOT_VERIFIED:"auth/email-not-verified",EXPIRED_ACTION_CODE:"auth/expired-action-code",INVALID_ACTION_CODE:"auth/invalid-action-code",USER_DISABLED:"auth/user-disabled",CREDENTIAL_ALREADY_IN_USE:"auth/credential-already-in-use",INVALID_CREDENTIAL:"auth/invalid-credential",ACCOUNT_EXISTS_WITH_DIFFERENT_CREDENTIAL:"auth/account-exists-with-different-credential"};n={},(0,u._)(n,l.EMAIL_ALREADY_IN_USE,"This email is already registered. Please use sign in to your existing account."),(0,u._)(n,l.INVALID_EMAIL,"Please enter a valid email address."),(0,u._)(n,l.USER_NOT_FOUND,"No account found with this email address."),(0,u._)(n,l.WRONG_PASSWORD,"Invalid email or password."),(0,u._)(n,l.WEAK_PASSWORD,"Password is too weak. Please choose a stronger password."),(0,u._)(n,l.REQUIRES_RECENT_LOGIN,"This action requires recent authentication. Please log in again before retrying."),(0,u._)(n,l.TOO_MANY_REQUESTS,"Too many login attempts. Please try again later."),(0,u._)(n,l.EMAIL_NOT_VERIFIED,"Please verify your email to continue."),(0,u._)(n,l.EXPIRED_ACTION_CODE,"This link has expired. Please request a new one."),(0,u._)(n,l.INVALID_ACTION_CODE,"This link is invalid or has already been used."),(0,u._)(n,l.USER_DISABLED,"This account has been disabled. Please contact support."),(0,u._)(n,l.CREDENTIAL_ALREADY_IN_USE,"This credential is already associated with another account."),(0,u._)(n,l.INVALID_CREDENTIAL,"Invalid email or password."),(0,u._)(n,l.ACCOUNT_EXISTS_WITH_DIFFERENT_CREDENTIAL,"An account already exists with this email. Please sign in with your password first, then link your Google account from Account Settings.");var d=r(16958),p=r(38597),f=(0,o.LC)({reducerPath:d.V.AUTH,baseQuery:s.hK,tagTypes:[d.q.USER,d.q.USER_IP],endpoints:function(e){return{getUserInfo:e.query({queryFn:function(e){var t=e.uid;return(0,a._)(function(){var e,r,n,a;return(0,i.Jh)(this,function(i){switch(i.label){case 0:return i.trys.push([0,5,,6]),[4,fetch("".concat(p.URLS.streamUrl,"/").concat(c.GET_USER_DATA),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uid:t})})];case 1:if((e=i.sent()).ok)return[3,3];return r={},n={status:e.status},[4,e.text()];case 2:return[2,(r.error=(n.data=i.sent(),n),r)];case 3:return[4,e.json()];case 4:return[2,{data:(null==(a=i.sent())?void 0:a.status)==="success"&&a.data}];case 5:return[2,{error:{status:"FETCH_ERROR",error:i.sent().message}}];case 6:return[2]}})})()},providesTags:function(e,t,r){var n=r.uid;return[{type:d.q.USER,id:n}]}}),findUserByEmail:e.query({queryFn:function(e){var t=e.email;return(0,a._)(function(){var e,r,n,a;return(0,i.Jh)(this,function(i){switch(i.label){case 0:return i.trys.push([0,5,,6]),[4,fetch("".concat(p.URLS.streamUrl,"/").concat(c.FIND_USER_BY_EMAIL),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t})})];case 1:if((e=i.sent()).ok)return[3,3];return r={},n={status:e.status},[4,e.text()];case 2:return[2,(r.error=(n.data=i.sent(),n),r)];case 3:return[4,e.json()];case 4:return[2,{data:(null==(a=i.sent())?void 0:a.status)==="success"&&a.data}];case 5:return[2,{error:{status:"FETCH_ERROR",error:i.sent().message}}];case 6:return[2]}})})()},keepUnusedDataFor:600}),updateUserData:e.mutation({query:function(e){return{url:c.UPDATE_USER_DATA,method:"POST",body:e}},invalidatesTags:function(e,t,r){var n=r.uid;return[{type:d.q.USER,id:n}]}}),updateTourGuide:e.mutation({query:function(e){return{url:c.UPDATE_TOUR_GUIDE,method:"POST",body:e}},invalidatesTags:function(e,t,r){var n=r.uid;return[{type:d.q.USER,id:n}]}}),updateContextualTips:e.mutation({query:function(e){return{url:c.UPDATE_CONTEXTUAL_TIPS,method:"PUT",body:e}},invalidatesTags:function(e,t,r){var n=r.uid;return[{type:d.q.USER,id:n}]}}),updateUserLinkToDB:e.mutation({query:function(e){return{url:c.UPDATE_USER_DATA,method:"POST",body:e}},invalidatesTags:function(e,t,r){var n=r.uid;return[{type:d.q.USER,id:n}]}}),userFeatureAnnouncement:e.mutation({query:function(e){return{url:c.USER_FEATURE_ANNOUNCEMENT,method:"POST",body:e}},invalidatesTags:function(e,t,r){var n=r.uid;return[{type:d.q.USER,id:n}]}}),addUserToDB:e.mutation({queryFn:function(e){return(0,a._)(function(){var t,r,n;return(0,i.Jh)(this,function(a){switch(a.label){case 0:return a.trys.push([0,5,,6]),[4,fetch("".concat(p.URLS.streamUrl,"/").concat(c.ADD_USER),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})];case 1:if((t=a.sent()).ok)return[3,3];return r={},n={status:t.status},[4,t.text()];case 2:return[2,(r.error=(n.data=a.sent(),n),r)];case 3:return[4,t.json()];case 4:return[2,{data:a.sent()}];case 5:return[2,{error:{status:"FETCH_ERROR",error:a.sent().message}}];case 6:return[2]}})})()}}),addToActiveCampaign:e.mutation({queryFn:function(e){return(0,a._)(function(){var t,r,n;return(0,i.Jh)(this,function(a){switch(a.label){case 0:return a.trys.push([0,5,,6]),[4,fetch("".concat(p.URLS.streamUrl,"/").concat(c.ADD_TO_AC),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})];case 1:if((t=a.sent()).ok)return[3,3];return r={},n={status:t.status},[4,t.text()];case 2:return[2,(r.error=(n.data=a.sent(),n),r)];case 3:return[4,t.json()];case 4:return[2,{data:a.sent()}];case 5:return[2,{error:{status:"FETCH_ERROR",error:a.sent().message}}];case 6:return[2]}})})()}}),getUserIp:e.query({queryFn:function(){return(0,a._)(function(){var e,t,r,n;return(0,i.Jh)(this,function(a){switch(a.label){case 0:return a.trys.push([0,5,,6]),[4,fetch(c.IPIFY)];case 1:if((e=a.sent()).ok)return[3,3];return t={},r={status:e.status},[4,e.text()];case 2:return[2,(t.error=(r.data=a.sent(),r.error=e.status,r),t)];case 3:return[4,e.json()];case 4:return[2,{data:a.sent()}];case 5:return[2,{error:{status:"FETCH_ERROR",data:void 0,error:(null==(n=a.sent())?void 0:n.message)||"Unknown fetch error"}}];case 6:return[2]}})})()},keepUnusedDataFor:600,providesTags:[d.q.USER_IP]}),updateUserProfile:e.mutation({query:function(e){return{url:c.UPDATE_USER_PROFILE,method:"POST",body:e}},invalidatesTags:function(e,t,r){var n=r.uid;return[{type:d.q.USER,id:n}]}})}}}),h=f.useGetUserInfoQuery,g=f.useLazyGetUserInfoQuery,_=(f.useFindUserByEmailQuery,f.useLazyFindUserByEmailQuery),m=f.useUpdateUserDataMutation,v=f.useUpdateContextualTipsMutation,E=f.useUpdateUserLinkToDBMutation,I=f.useAddUserToDBMutation,U=f.useAddToActiveCampaignMutation,y=(f.useGetUserIpQuery,f.useLazyGetUserIpQuery),S=f.useUserFeatureAnnouncementMutation,A=f.useUpdateUserProfileMutation,w=f.useUpdateTourGuideMutation},65800:function(e,t,r){r.d(t,{hK:function(){return U}});var n,a,i,o,s,u=r(45610),c=r(41369),l=r(43654),d=r(50044),p=r(55345),f=r(38597),h=r(30791),g=r(60453),_=!1,m=0,v=(n=(0,u._)(function(){var e,t,r,n,a,i,o;return(0,d.Jh)(this,function(s){switch(s.label){case 0:if(s.trys.push([0,7,,8]),e=localStorage.getItem("tokenId"),!(t=h.I8.currentUser))throw console.error("[AUTH] No user logged in, dispatching session expired"),(0,g.hb)(g.zW.sessionExpired),Error("No user logged in");if(!_)return[3,2];if(e)return[2,e];return[4,new Promise(function(e){return setTimeout(e,1e3)})];case 1:if(s.sent(),r=localStorage.getItem("tokenId"))return[2,r];s.label=2;case 2:if(++m>3)throw console.error("[AUTH] Maximum token refresh attempts exceeded, possible infinite loop"),m=0,(0,g.hb)(g.zW.sessionExpired),Error("Maximum token refresh attempts exceeded");s.label=3;case 3:return s.trys.push([3,5,,6]),_=!0,[4,t.getIdToken(!1)];case 4:if(!(n=s.sent()))throw console.error("[AUTH] Failed to get token"),a=Error("Failed to get token"),(0,g.hb)(g.zW.sessionExpired),a;return localStorage.setItem("tokenId",n),_=!1,m=0,[2,n];case 5:throw console.error("[AUTH] Error getting token:",i=s.sent()),_=!1,(0,g.hb)(g.zW.sessionExpired),i;case 6:return[3,8];case 7:throw o=s.sent(),_=!1,o instanceof Error&&("No user logged in"===o.message||"Failed to get token"===o.message)||(console.error("[AUTH] Unexpected error in getIdToken:",o),(0,g.hb)(g.zW.sessionExpired)),o;case 8:return[2]}})}),function(){return n.apply(this,arguments)}),E=(a=(0,u._)(function(){var e,t;return(0,d.Jh)(this,function(r){switch(r.label){case 0:if(r.trys.push([0,2,,3]),!(e=h.I8.currentUser))return[2,!1];return[4,e.getIdToken(!0)];case 1:if(t=r.sent())return localStorage.setItem("tokenId",t),[2,!0];return[2,!1];case 2:return console.error("[AUTH] Token refresh failed:",r.sent()),[2,!1];case 3:return[2]}})}),function(){return a.apply(this,arguments)}),I=(i=(0,u._)(function(){var e,t,r=arguments;return(0,d.Jh)(this,function(n){switch(n.label){case 0:e=r.length>0&&void 0!==r[0]?r[0]:{},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,v()];case 2:return t=n.sent(),[2,(0,l._)((0,c._)({},e),{Authorization:t})];case 3:return console.error("[AUTH] Error adding token to headers:",n.sent()),[2,e];case 4:return[2]}})}),function(){return i.apply(this,arguments)});(0,u._)(function(e){var t;return(0,d.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,v()];case 1:if(t=r.sent(),"string"==typeof e)return[2,{url:e,headers:{Authorization:t}}];return[2,(0,l._)((0,c._)({},e),{headers:(0,l._)((0,c._)({},e.headers),{Authorization:t})})];case 2:return console.error("[AUTH] Failed to add token to request:",r.sent()),[2,e];case 3:return[2]}})});var U=(0,p.ni)({baseUrl:f.URLS.streamUrl,prepareHeaders:(o=(0,u._)(function(e){var t;return(0,d.Jh)(this,function(r){switch(r.label){case 0:return[4,I(Object.fromEntries(e.entries()))];case 1:return t=r.sent(),[2,new Headers(t)]}})}),function(e){return o.apply(this,arguments)}),responseHandler:(s=(0,u._)(function(e){var t,r;return(0,d.Jh)(this,function(n){switch(n.label){case 0:if(e.ok)return[3,4];if(!(401===(t=e.status)||403===t))return[3,2];return[4,E()];case 1:if(n.sent())return[2,Promise.reject({status:"CUSTOM_TOKEN_REFRESH",data:{message:"Token refreshed, please retry"}})];console.error("[AUTH] Token refresh failed, session expired"),(0,g.hb)(g.zW.sessionExpired),n.label=2;case 2:return[4,e.json().catch(function(){return{}})];case 3:return r=n.sent(),[2,Promise.reject({status:e.status,data:r})];case 4:return[2,e.json()]}})}),function(e){return s.apply(this,arguments)})})}}]);